---
import CardGroup from "@/components/card/CardGroup.astro";
import Card from "@/components/card/Card.astro";
import CardBody from "@/components/card/CardBody.astro";
import CardImage from "@/components/card/CardImage.astro";
import CardHeader from "@/components/card/CardHeader.astro";
import CardBackground from "@/components/card/CardBackground.astro";
import 'jdls-boids-canvas';
import CardContent from "@/components/card/CardContent.astro";
import { clsx } from "clsx";

interface Project {
    id: string;
    title: string;
    link?: string;
    shortExcerpt: string;
    type?: string;
    component?: string;
    badgeContent?: string;
    logo?: string;
    post?: string;
    image?: string;
}

export interface Props {
    projects: Project[];
}

const { projects } = Astro.props;
---

<CardGroup
    class="grid scroll-m-24 gap-4 grid-cols-1 md:grid-cols-2 xl:grid-cols-3 w-full p-4"
>
    {
        projects.map((project) => (
            <Card
                as="a"
                href={project.post || project.link}
                target="_blank"
                class={clsx(
                    "col-span-1",
                    project.type === "hero" && "md:col-span-2"
                )}
                aspectRatio="4/3"
                bordered={project.type === "bordered"}
            >
                {project.image && (
                    <CardBackground src={project.image} alt={project.title} />
                )}
                {!!project.badgeContent && (
                    <div class="badge-group text-sm w-auto absolute mb-0 m-6 z-10">
                        <div class="badge-group--container w-auto items-center rounded-full border border-secondary-200 dark:border-secondary-700 bg-background px-1 py-[2px] font-medium text-primary-500 inline-flex transition-colors duration-300">
                            <div class="badge-group--message px-2">
                                {project.badgeContent}
                            </div>
                        </div>
                    </div>
                )}
                {project.component && <boids-canvas background-color="#5162FF" light-color="#FFFCEC" fog-color="#9DA7FF" boid-color="#40e0d0" highlight="#ffc0cb" count="150" use-orbit-controls="true" duration="30" forces='{"separation": 0.9, "cohesion": 0.85, "alignment": 0.2, "goal": 0.3}' orientation-slerp="0.2" />}
                <CardBody>
                    {project.logo &&
                    <CardImage
                        src={project.logo}
                        alt="Articoole Banner"
                        imageClass="absolute top-0 right-0 m-6 p-4 bg-background rounded-3xl transition-colors duration-300"
                        width={80}
                        height={80}
                    />}
                    {/* <div class="absolute bottom-0 left-0 right-0 h-48 backdrop-blur-xs bg-black/50 [mask-image:linear-gradient(to_top,black_20%,transparent_100%)] pointer-events-none rounded-xl"></div> */}
                    {/* <CardContent class="absolute bottom-0 left-0 right-0 p-6 z-10 rounded-b-xl">
                        <CardHeader class="">
                            {project.title}
                        </CardHeader>
                        <div class="content break-words text-2xl font-medium leading-10 tracking-tight lg:tracking-tighter text-neutral-50">
                            <p>{project.shortExcerpt}</p>
                        </div>
                    </CardContent> */}
                </CardBody>
            </Card>
        ))
    }
</CardGroup>

<script>
    // Only load the webcomponent in the browser
    if (typeof window !== 'undefined') {
        import('jdls-boids-canvas').catch(err => {
            console.warn('Failed to load boids webcomponent:', err);
        });
    }
</script>